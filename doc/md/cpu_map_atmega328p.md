Arduino的针脚分为

- B (digital pin 8 to 13)
- C (analog input pins)
- D (digital pins 0 to 7)

| 名称     | 针脚/寄存器     | 权限                       | 备注                                                         |
| -------- | --------------- | -------------------------- | ------------------------------------------------------------ |
| 串口通信 | USART_RX_vect   | 中断                       | 串口有数据可以接（每次中断也即有一个字节，所以每次读取一个字节） |
|          | USART_URDE_vect | 中断                       | 串口可以发送数据（每次发送一个字节）                         |
|          | UDR0            | 串口端口                   | 用于收发数据，因为采用的是同步，所以发送接收使用的是同一个链路 |
|          |                 |                            | <font color="green">支持硬串口与软串口<br />硬串口即使用板子上的串口<br />软件串口即可以自定义两个针脚用作收发（可实现Arduino的级联）</font> |
|          |                 |                            |                                                              |
| X步进    | D2              | 读写                       |                                                              |
| Y步进    | D3              | 读写                       |                                                              |
| Z步进    | D4              | 读写                       |                                                              |
| X方向    | D5              | 读写                       |                                                              |
| Y方向    | D6              | 读写                       |                                                              |
| Z方向    | D7              | 读写                       |                                                              |
| 使能     | D8              | 读写                       |                                                              |
| X限位    | D9              | 只读                       |                                                              |
| Y限位    | D10             | 只读                       |                                                              |
| Z限位    | D11             | 只读                       | 主轴定速                                                     |
|          | D12             | 只读                       | 主轴是变速的即使用PWM占空比调节，主轴使能有可能会占用D11     |
|          |                 |                            |                                                              |
| 主轴使能 | D13             | 读写                       | 变速主轴，且主轴的反向与使能使用同一个针脚                   |
|          | D11             | 读写                       | 变速主轴，但方向单独控制                                     |
|          | D13             | 读写                       | 定速主轴                                                     |
| 主轴方向 | D13             | 读写                       |                                                              |
| 变速主轴 |                 |                            | 变速是通过占空比PWM来实现。<br />此处选择Timer2来控制PWM。<br />Timer2为8bit，从0到255，然后再从0到255<br />TCCRA的低两位与TCCR2B的第4bit组合决定占空比的模式<br />TRRR2B的低三位决定预除数<br />时钟频率/255/预除数得到输出的脉冲频率<br />在FAST模式下，OCR2A控制D11，OCR2B控制针D3<br /><br />GRBL只使用了OCR2A（此处的2是因为Timer2，其他定时器也有其对应的）<br /><br />具体参照：https://www.jianshu.com/p/c7608a0b6c92 |
|          | Timer2          | 内置                       | 不可更改，因为Timer0用于控制主程序的Delay等。Timer1是16bit（有点浪费性能） |
|          | OCR2A           | 比较器                     | 此处OCR2A中的2是因为选择了Timer2。<br />定时器计数开始为高电平，<br />当到达比较器设定的值时开始输出低电平<br />周而复始<br />最大值为255，即一直高电平 |
|          | TCCR2A/B        | 波形模式<br />频率<br />等 |                                                              |
|          |                 |                            |                                                              |
| 冷却液   | A3              | 读写                       |                                                              |
| 冷却雾   | A4              | 读写                       | 默认不支持，需要通过配置文件打开                             |
|          |                 |                            |                                                              |
| 探针     | A5              | 读写                       | 对刀。步骤如下：<br />1、用一个金属块放到工件表面<br />2、并用导线连接到Arduino地，<br />3、用一个鳄鱼夹夹住能导电的刀头，并连接到Arduino的A5引脚。<br />4、当开启对刀后Z轴缓慢向下移动，<br />5、当刀头接触到金属块时停止，<br />6、并设置当前Z轴的位置为Z轴零点，然后提升Z轴到安全位置<br />7、最后拿掉对刀仪。 |
|          |                 |                            |                                                              |
| 外部控制 |                 |                            |                                                              |
| 重置     | A0              | 只读                       | 重启系统                                                     |
| 锁床     | A1              | 只读                       | FEED_HOLD，锁定机床键。按一次锁定，机床不能执行，再按一次恢复 |
| 循环加工 | A2              | 只读                       | CYCLE_START_BIT，暂时未理解该外部控制的作用                  |
| 安全门   | A1              | 只读                       | SAFETY_DOOR。机床边上会有一个栅栏围起来，然后有一个门。这个门就叫安全门<br />门上面接线到A1上，当门打开时触发机床锁定，从而保证安全。门关闭时恢复 |
| 触发     | PCIE1           | 中断                       | A0、A1、A2针脚信息发生变化时触发该中断。对应的中断向量为PCINT1_vect<br />在对应的中断函数中判别是哪个针脚引发，然后进行对应的处理 |





atmega328p与atmega2560比较：

|      | atmega328p | atmega2560 |
| ---- | ---------- | ---------- |
| 主频 | 16MHZ      | 16MHZ      |
| 存储 | 128KB      | 256KB      |
| D    | 14         | 54         |
| A    | 6          | 16         |
| PMW  | 6          | 15         |
|      |            |            |
|      |            |            |





